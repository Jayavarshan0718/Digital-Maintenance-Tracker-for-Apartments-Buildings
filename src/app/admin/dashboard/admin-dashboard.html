<div class="modern-admin-dashboard">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="header-content">
      <div class="title-section">
        <div class="icon-wrapper">
          <svg class="admin-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
        </div>
        <div>
          <h1 class="dashboard-title">Admin Control Center</h1>
          <p class="dashboard-subtitle">Manage and monitor all maintenance operations</p>
        </div>
      </div>
      <div class="header-actions">
        <button class="refresh-btn" (click)="loadAllRequests()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M1 4v6h6M23 20v-6h-6"/>
            <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
          </svg>
          Refresh
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p class="loading-text">Loading dashboard data...</p>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading" class="dashboard-content">
    
    <!-- Stats Cards -->
    <div class="stats-section">
      <div class="stat-card total">
        <div class="stat-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M9 11H5a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2z"/>
            <path d="M19 7h-4a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.total }}</div>
          <div class="stat-label">Total Requests</div>
        </div>
      </div>

      <div class="stat-card pending">
        <div class="stat-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12,6 12,12 16,14"/>
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.pending }}</div>
          <div class="stat-label">Pending</div>
        </div>
      </div>

      <div class="stat-card progress">
        <div class="stat-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.inProgress }}</div>
          <div class="stat-label">In Progress</div>
        </div>
      </div>

      <div class="stat-card completed">
        <div class="stat-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22,4 12,14.01 9,11.01"/>
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.completed }}</div>
          <div class="stat-label">Completed</div>
        </div>
      </div>
    </div>

    <!-- Requests Table -->
    <div class="requests-section">
      <div class="section-header">
        <h2 class="section-title">Maintenance Requests</h2>
        <div class="section-actions">
          <div class="search-box">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
            <input type="text" placeholder="Search requests...">
          </div>
        </div>
      </div>

      <div class="table-container">
        <table class="modern-table">
          <thead>
            <tr>
              <th>Request ID</th>
              <th>Category</th>
              <th>Description</th>
              <th>Resident</th>
              <th>Priority</th>
              <th>Date Created</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let request of requests; trackBy: trackByRequestId" class="table-row">
              <td class="request-id">
                <span class="id-badge">#{{ request.id }}</span>
              </td>
              <td>
                <div class="category-tag">
                  <span class="category-icon">ðŸ”§</span>
                  {{ request.category }}
                </div>
              </td>
              <td class="description-cell">
                <div class="description-text">{{ request.description }}</div>
              </td>
              <td>
                <div class="resident-info">
                  <span class="resident-avatar">R</span>
                  Resident {{ request.resident_id }}
                </div>
              </td>
              <td>
                <span class="priority-badge" [ngClass]="getPriorityClass(request.priority)">
                  {{ request.priority || 'Medium' }}
                </span>
              </td>
              <td class="date-cell">
                {{ request.created_at | date:'MMM d, y' }}
              </td>
              <td>
                <span class="status-badge" [ngClass]="getStatusClass(request.status)">
                  {{ request.status || 'Pending' }}
                </span>
              </td>
              <td class="actions-cell">
                <div class="action-buttons" *ngIf="request.status !== 'Resolved'; else completedLabel">
                  <button 
                    class="action-btn assign-btn" 
                    (click)="updateRequestStatus(request.id, 'Assigned')"
                    [disabled]="request.status === 'Assigned'"
                    title="Assign to Technician">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                      <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                      <circle cx="8.5" cy="7" r="4"/>
                      <line x1="20" y1="8" x2="20" y2="14"/>
                      <line x1="23" y1="11" x2="17" y2="11"/>
                    </svg>
                    {{ request.status === 'Assigned' ? 'Assigned' : 'Assign' }}
                  </button>
                  <button 
                    class="action-btn complete-btn" 
                    (click)="updateRequestStatus(request.id, 'Resolved')"
                    title="Mark as Completed">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                      <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                      <polyline points="22,4 12,14.01 9,11.01"/>
                    </svg>
                    Complete
                  </button>
                </div>
                <ng-template #completedLabel>
                  <div class="completed-label">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                      <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                      <polyline points="22,4 12,14.01 9,11.01"/>
                    </svg>
                    Task Completed
                  </div>
                </ng-template>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
